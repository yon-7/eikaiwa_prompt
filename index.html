<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Prompt Maker</title>
    
    <!-- ã‚¹ãƒãƒ›ç”¨ã‚¢ã‚¤ã‚³ãƒ³è¨­å®š -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%2328a745'/><text x='50' y='70' font-family='Arial, sans-serif' font-weight='bold' font-size='70' fill='white' text-anchor='middle'>E</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%2328a745'/><text x='50' y='70' font-family='Arial, sans-serif' font-weight='bold' font-size='70' fill='white' text-anchor='middle'>E</text></svg>">

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Segoe UI", sans-serif; background: #f0f2f5; color: #333; padding: 20px 15px; max-width: 480px; margin: 0 auto; }
        h1 { text-align: center; color: #333; margin-bottom: 25px; margin-top: 10px; }
        .app-title { font-family: 'Arial Black', sans-serif; font-size: 1.8em; letter-spacing: 1px; color: #2c3e50; display: block; }
        .app-description { font-size: 0.85em; color: #666; line-height: 1.6; margin: 5px 0 0 0; }
        .app-description span { display: inline-block; }
        .card { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
        label { display: block; margin-top: 15px; font-weight: bold; font-size: 0.9em; color: #555; }
        select, input[type="text"] { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; background-color: #fff; -webkit-appearance: none; }
        .hidden { display: none; }
        
        /* ãƒ¢ãƒ¼ãƒ‰é¸æŠãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .radio-group { 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 10px; 
            margin-bottom: 20px; 
        }
        
        @media (min-width: 500px) {
            .radio-group { 
                grid-template-columns: 1fr 1fr 1fr; 
                background: #e4e6eb;
                padding: 5px;
                border-radius: 10px;
                gap: 0;
            }
        }

        .radio-label { 
            text-align: center; 
            padding: 12px 5px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.95em; 
            font-weight: bold; 
            color: #555; 
            background: #fff;
            border: 1px solid #ddd;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (min-width: 500px) {
            .radio-label {
                background: transparent;
                border: none;
                color: #65676b;
            }
        }

        input[type="radio"] { display: none; }
        
        input[type="radio"]:checked + .radio-label { 
            background: #e7f5ea;
            color: #28a745; 
            border-color: #28a745; 
            box-shadow: 0 2px 5px rgba(40, 167, 69, 0.2);
        }

        @media (min-width: 500px) {
            input[type="radio"]:checked + .radio-label { 
                background: #fff; 
                border: none;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
        }

        textarea { width: 100%; height: 200px; padding: 12px; border: 1px solid #ccc; border-radius: 8px; background: #fafafa; font-family: monospace; font-size: 13px; box-sizing: border-box; resize: none; margin-top: 5px; }
        
        button { width: 100%; padding: 14px; background: #28a745; color: white; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 6px rgba(40, 167, 69, 0.2); transition: background 0.2s; }
        button:active { transform: scale(0.98); }
        
        .checkbox-wrapper { margin-top: 20px; display: flex; align-items: center; padding: 10px; background: #f9f9f9; border-radius: 8px; }
        .checkbox-wrapper input { width: 20px; height: 20px; margin-right: 10px; accent-color: #28a745; }
    </style>
</head>
<body>

    <!-- ã‚¿ã‚¤ãƒˆãƒ«ã¨èª¬æ˜æ–‡ -->
    <div style="text-align: center; margin: 10px 0 15px 0;">
         <h1 style="margin: 0; font-size: 1.4em; font-family: 'Arial Black', sans-serif; color: #2c3e50;">
            English Prompt Maker
        </h1>
        <p style="margin: 2px 0 0 0; font-size: 0.8em; color: #28a745; font-weight: bold;">
            ChatGPTç”¨ è‹±ä¼šè©±ç·´ç¿’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆãƒ„ãƒ¼ãƒ«
        </p>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ‰é¸æŠ -->
    <div class="radio-group">
        <label>
            <input type="radio" name="mode" value="roleplay" checked onchange="handleModeChange()">
            <span class="radio-label">ğŸ¬ ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤</span>
        </label>
        <label>
            <input type="radio" name="mode" value="freetalk" onchange="handleModeChange()">
            <span class="radio-label">ğŸ—£ï¸ ãƒ•ãƒªãƒ¼ãƒˆãƒ¼ã‚¯</span>
        </label>
        <label>
            <input type="radio" name="mode" value="translation" onchange="handleModeChange()">
            <span class="radio-label">âš¡ï¸ ç¬é–“è‹±ä½œæ–‡</span>
        </label>
    </div>

    <div class="card" id="form-container">
        
        <!-- ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤å°‚ç”¨é …ç›® -->
        <div id="roleplay-fields">
            <label>ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ (å ´é¢)</label>
            <select id="situation" onchange="checkCustom('situation')">
                <option value="Ordering a coffee at a cafe">â˜•ï¸ ã‚«ãƒ•ã‚§ã§æ³¨æ–‡</option>
                <option value="Checking in at a hotel">ğŸ¨ ãƒ›ãƒ†ãƒ«ã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</option>
                <option value="Restaurant reservation">ğŸ½ï¸ ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³äºˆç´„</option>
                <option value="Buying souvenirs at a gift shop">ğŸ ãŠåœŸç”£å±‹ã§ã®è²·ã„ç‰©</option>
                <option value="Immigration control at the airport">âœˆï¸ ç©ºæ¸¯ã®å…¥å›½å¯©æŸ»</option>
                <option value="Asking for directions">ğŸ—ºï¸ é“æ¡ˆå†…ã‚’èã</option>
                <option value="Job interview">ğŸ‘” å°±è·é¢æ¥</option>
                <option value="At the pharmacy">ğŸ’Š ç—…é™¢ã§ç›¸è«‡</option>
                <option value="Meeting someone new at a party">ğŸ¥‚ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã§åˆå¯¾é¢ã®äººã¨è©±ã™</option>
                <option value="Networking event (Business)">ğŸ“‡ ãƒ“ã‚¸ãƒã‚¹äº¤æµä¼šã§ååˆºäº¤æ›</option>
                <option value="Small talk in the elevator/park">ğŸ—£ï¸ ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã‚„å…¬åœ’ã§ã®ä¸–é–“è©±</option>
                <option value="custom">âœï¸ ãã®ä»– (è‡ªç”±å…¥åŠ›)</option>
            </select>
            <input type="text" id="situation-custom" class="hidden" placeholder="ä¾‹: ç¾å®¹é™¢ã§é«ªå‹ã‚’æ³¨æ–‡ã™ã‚‹">

            <label>ç›¸æ‰‹(AI)ã®å½¹å‰²</label>
            <select id="ai-role" onchange="checkCustom('ai-role')">
                <option value="Friendly Staff">ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªåº—å“¡</option>
                <option value="Serious Officer">å³æ ¼ãªä¿‚å“¡</option>
                <option value="Kind Stranger">è¦ªåˆ‡ãªé€šè¡Œäºº</option>
                <option value="Interviewer">é¢æ¥å®˜</option>
                <option value="Doctor">åŒ»è€…</option>
                <option value="Friendly Stranger">ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªçŸ¥ã‚‰ãªã„äºº</option>
                <option value="custom">âœï¸ ãã®ä»– (è‡ªç”±å…¥åŠ›)</option>
            </select>
            <input type="text" id="ai-role-custom" class="hidden" placeholder="ä¾‹: è¿‘æ‰€ã®ä½äºº">

            <label>è‡ªåˆ†ã®å½¹å‰²</label>
            <select id="my-role" onchange="checkCustom('my-role')">
                <option value="Customer/Tourist">å®¢ / è¦³å…‰å®¢</option>
                <option value="Lost Person">é“ã«è¿·ã£ãŸäºº</option>
                <option value="Patient">æ‚£è€…</option>
                <option value="Myself">è‡ªåˆ†è‡ªèº«</option>
                <option value="custom">âœï¸ ãã®ä»– (è‡ªç”±å…¥åŠ›)</option>
            </select>
            <input type="text" id="my-role-custom" class="hidden" placeholder="ä¾‹: ã‚¯ãƒ¬ãƒ¼ãƒ ã‚’è¨€ã†å®¢">
        </div>

        <!-- ãƒ•ãƒªãƒ¼ãƒˆãƒ¼ã‚¯å°‚ç”¨é …ç›® -->
        <div id="freetalk-fields" class="hidden">
            <label>ãƒˆãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ</label>
            <select id="topic" onchange="checkCustom('topic')">
                <option value="My Hobbies">è¶£å‘³ã«ã¤ã„ã¦</option>
                <option value="Recent Movies/Anime">æœ€è¿‘è¦‹ãŸæ˜ ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡</option>
                <option value="Travel experiences">æ—…è¡Œã®ä½“é¨“</option>
                <option value="Future technology">æœªæ¥ã®æŠ€è¡“ã«ã¤ã„ã¦</option>
                <option value="Daily news">æœ€è¿‘ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
                <option value="Career goals">ä»•äº‹ãƒ»ã‚­ãƒ£ãƒªã‚¢ã®ç›®æ¨™</option>
                <option value="Japanese Culture">æ—¥æœ¬ã®æ–‡åŒ–èª¬æ˜</option>
                <option value="custom">âœï¸ ãã®ä»– (è‡ªç”±å…¥åŠ›)</option>
            </select>
            <input type="text" id="topic-custom" class="hidden" placeholder="ä¾‹: å¥åº·çš„ãªç”Ÿæ´»ã«ã¤ã„ã¦">
        </div>

        <!-- ç¬é–“è‹±ä½œæ–‡å°‚ç”¨é …ç›® -->
        <div id="translation-fields" class="hidden">
            <label>ç‰¹è¨“ã—ãŸã„ãƒ†ãƒ¼ãƒãƒ»æ–‡æ³•</label>
            <select id="trans-focus" onchange="checkCustom('trans-focus')">
                <option value="General (Random mix)">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ  (ç·åˆ)</option>
                <option value="Basic Grammar (Middle School Level)">ğŸ« ä¸­å­¦è‹±èªã®ç·å¾©ç¿’</option>
                <option value="Past Tense & Future Tense">â³ éå»å½¢ãƒ»æœªæ¥å½¢</option>
                <option value="Prepositions (in, on, at...)">ğŸ“ å‰ç½®è© (in, on, atãªã©)</option>
                <option value="Travel Phrases">âœˆï¸ æ—…è¡Œã§ä½¿ãˆã‚‹ãƒ•ãƒ¬ãƒ¼ã‚º</option>
                <option value="Business English">ğŸ’¼ ãƒ“ã‚¸ãƒã‚¹è‹±èª</option>
                <option value="Keigo / Polite expressions">ğŸ¤µ ä¸å¯§èªãƒ»æ•¬èªè¡¨ç¾</option>
                <option value="custom">âœï¸ ãã®ä»– (è‡ªç”±å…¥åŠ›)</option>
            </select>
            <input type="text" id="trans-focus-custom" class="hidden" placeholder="ä¾‹: é–¢ä¿‚ä»£åè©ã‚’ä½¿ã£ãŸæ–‡">
        </div>

        <!-- å…±é€šè¨­å®š -->
        <div id="first-speaker-wrapper">
            <label>ä¼šè©±ã®é–‹å§‹ (ã©ã¡ã‚‰ã‹ã‚‰è©±ã™ï¼Ÿ)</label>
            <select id="first-speaker" onchange="saveAndGenerate()">
                <option value="ai">ğŸ¤– AIã‹ã‚‰è©±ã—ã‹ã‘ã‚‹ (AI speaks first)</option>
                <option value="user">ğŸ™‹â€â™‚ï¸ è‡ªåˆ†ã‹ã‚‰è©±ã—ã‹ã‘ã‚‹ (I speak first)</option>
            </select>
        </div>

        <label>è‹±èªãƒ¬ãƒ™ãƒ« (CEFRåŸºæº–)</label>
        <select id="level">
            <option value="A1 (Beginner)">A1 - å…¥é–€ (å˜èªãƒ»æŒ¨æ‹¶ãƒ¬ãƒ™ãƒ«)</option>
            <option value="A2 (Elementary)">A2 - åˆç´š (ç°¡å˜ãªæ—¥å¸¸ä¼šè©±)</option>
            <option value="B1 (Intermediate)">B1 - ä¸­ç´š (æ—…è¡Œãƒ»ä»•äº‹ã®åŸºæœ¬)</option>
            <option value="B2 (Upper Intermediate)">B2 - ä¸­ä¸Šç´š (è¤‡é›‘ãªè©±é¡Œã‚‚OK)</option>
            <option value="C1 (Advanced)">C1 - ä¸Šç´š (æµæš¢ã«è­°è«–å¯èƒ½)</option>
            <option value="C2 (Proficiency)">C2 - ç‰¹ç´š (ãƒã‚¤ãƒ†ã‚£ãƒ–åŒç­‰)</option>
        </select>

        <label>AIã®è©±ã™é€Ÿåº¦ (ãƒœã‚¤ã‚¹ãƒ¢ãƒ¼ãƒ‰æ™‚)</label>
        <select id="speed">
            <option value="extremely slowly, pausing slightly between phrases">ğŸŒ è¶…ã‚†ã£ãã‚Š (ãƒ•ãƒ¬ãƒ¼ã‚ºã”ã¨ã«åŒºåˆ‡ã‚‹)</option>
            <option value="very slowly and clearly">ğŸ¢ ã¨ã¦ã‚‚ã‚†ã£ãã‚Š</option>
            <option value="slowly">ğŸš¶ ã‚†ã£ãã‚Š</option>
            <option value="at natural speed">ğŸƒ æ™®é€š (ãƒŠãƒãƒ¥ãƒ©ãƒ«)</option>
            <option value="fast">ğŸï¸ æ—©å£ (ä¸Šç´šè€…å‘ã‘)</option>
        </select>

        <div class="checkbox-wrapper">
            <input type="checkbox" id="voice-mode-check" checked onchange="saveAndGenerate()">
            <label for="voice-mode-check" style="margin-top:0;">ãƒœã‚¤ã‚¹ãƒ¢ãƒ¼ãƒ‰é–‹å§‹ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥ã‚Œã‚‹</label>
        </div>
    </div>

    <!-- çµæœè¡¨ç¤º -->
    <div class="card">
        <label style="margin-top:0">ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</label>
        <textarea id="output" readonly onclick="this.select()"></textarea>
        <button onclick="copyToClipboard()">ğŸ“‹ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>

    <script>
        function saveAndGenerate() {
            saveSettings();
            generatePrompt();
        }

        function handleModeChange() {
            toggleMode();
            saveAndGenerate();
        }

        function toggleMode() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            document.getElementById('roleplay-fields').classList.add('hidden');
            document.getElementById('freetalk-fields').classList.add('hidden');
            document.getElementById('translation-fields').classList.add('hidden');

            const firstSpeakerWrapper = document.getElementById('first-speaker-wrapper');
            
            if (mode === 'roleplay') {
                document.getElementById('roleplay-fields').classList.remove('hidden');
                if(firstSpeakerWrapper) firstSpeakerWrapper.classList.remove('hidden');
            } else if (mode === 'freetalk') {
                document.getElementById('freetalk-fields').classList.remove('hidden');
                if(firstSpeakerWrapper) firstSpeakerWrapper.classList.remove('hidden');
            } else if (mode === 'translation') {
                document.getElementById('translation-fields').classList.remove('hidden');
                if(firstSpeakerWrapper) firstSpeakerWrapper.classList.add('hidden');
            }
        }

        function checkCustom(id) {
            const select = document.getElementById(id);
            const input = document.getElementById(id + '-custom');
            if (select.value === 'custom') {
                input.classList.remove('hidden');
            } else {
                input.classList.add('hidden');
            }
            saveAndGenerate();
        }

        document.querySelectorAll('select, input').forEach(el => {
            if(el.type !== 'radio') {
                el.addEventListener('input', saveAndGenerate);
            }
        });

        function getValue(id) {
            const select = document.getElementById(id);
            if (select.value === 'custom') {
                const input = document.getElementById(id + '-custom');
                return input.value || "[æœªå…¥åŠ›]";
            }
            return select.value;
        }

        function generatePrompt() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const level = document.getElementById('level').value;
            const speed = document.getElementById('speed').value;
            const useVoiceMode = document.getElementById('voice-mode-check').checked;
            const firstSpeaker = document.getElementById('first-speaker').value;

            let prompt = "";

            if (mode === 'roleplay') {
                const situation = getValue('situation');
                const aiRole = getValue('ai-role');
                const myRole = getValue('my-role');
                // ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤
                prompt = `# Instruction
I want to practice English conversation through role-playing.
Please act according to the following settings.

# Settings
- **Situation**: ${situation}
- **Your Role**: ${aiRole}
- **My Role**: ${myRole}
- **My English Level**: ${level}

# Rules
1. Speak naturally as your role.
2. **Wait for my response** after every sentence.
3. Keep your responses concise (1-3 sentences).
4. If I make a mistake, please correct it briefly inside parentheses like this: (Correction: ...) after your reply.
5. If using Voice Mode, please speak **${speed}**.`;

            } else if (mode === 'freetalk') {
                const topic = getValue('topic');
                // ãƒ•ãƒªãƒ¼ãƒˆãƒ¼ã‚¯
                prompt = `# Instruction
I want to have a free conversation about a specific topic to practice English.

# Topic
${topic}

# Settings
- **My English Level**: ${level}
- **Speaking Style**: Friendly and casual.

# Rules
1. Ask me questions to keep the conversation going.
2. Reply with only 1-3 sentences at a time.
3. Correct my grammar or vocabulary mistakes at the end of your response politely.
4. If using Voice Mode, please speak **${speed}**.`;

            } else if (mode === 'translation') {
                const focus = getValue('trans-focus');
                // ç¬é–“è‹±ä½œæ–‡
                prompt = `# Instruction
I want to practice "Instant English Composition" (Shunkan Eisakubun).
Act as a strict but helpful English teacher.

# Settings
- **Target Level**: ${level}
- **Focus Area**: ${focus}
- **Speaking Speed (English)**: ${speed}

# Rules
1. **Game Flow**: 
   - Keep counting the questions (Q1, Q2, ...).
   - **Continuous Flow**: Do not stop after every question.
   - **Checkpoint**: Only **after every 10 questions** (Q10, Q20...), pause and ask "Do you want to continue?".

2. **Speaking Speed (Important)**:
   - **Japanese (Question)**: Always speak at **NATURAL speed** (standard).
   - **English (Answer/Feedback)**: Speak **${speed}**.

3. **Step-by-Step Process (Repeat loop)**:
   - Step 1: Say the Question Number and the **Japanese sentence** (Natural speed).
   - Step 2: **Wait** for my translation.
   - Step 3: **Read the correct English sentence aloud** clearly (${speed}).
   - Step 4: **Immediately** go to Step 1 for the next question (No pause, no "Next question" announcement, just say the number and Japanese).`;
            }

            // --- é–‹å§‹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®åˆ¶å¾¡ ---
            const isAiFirst = (mode === 'translation') || (firstSpeaker === 'ai');

            if (useVoiceMode) {
                prompt += `\n\n# Start Sequence\n**Do not start the conversation yet.** Just reply with "**Ready**" in text.\nI will switch to Voice Mode.`;
                
                const triggers = '"**Hello**", "**Hi**", "**Start**", or "**Action**"';

                if (mode === 'translation') {
                    prompt += ` Then, I will say ${triggers}. Please **start Question 1 immediately** (You speak first).`;
                } else if (isAiFirst) {
                    prompt += ` Then, I will say ${triggers}. Please **speak the first sentence** to start the conversation.`;
                } else {
                    prompt += ` Then, **I will speak the first sentence immediately**. Please wait for my input and respond naturally.`;
                }

            } else {
                if (mode === 'roleplay') {
                    prompt += isAiFirst ? `\n\nLet's start the role-play. You speak first.` : `\n\nLet's start the role-play. I will speak first. Wait for my input.`;
                } else if (mode === 'freetalk') {
                    prompt += isAiFirst ? `\n\nLet's start. Please ask me the first question about the topic.` : `\n\nLet's start. I will speak first about the topic.`;
                } else if (mode === 'translation') {
                    prompt += `\n\nLet's start. Please give me the first Japanese sentence.`;
                }
            }

            document.getElementById('output').value = prompt;
        }

        function copyToClipboard() {
            const copyText = document.getElementById("output");
            copyText.select();
            document.execCommand("copy");
            const btn = document.querySelector("button");
            const originalText = btn.innerText;
            btn.innerText = "âœ… ã‚³ãƒ”ãƒ¼å®Œäº†ï¼";
            setTimeout(() => { btn.innerText = originalText; }, 2000);
        }

        function saveSettings() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            localStorage.setItem('epg_mode', mode);
            localStorage.setItem('epg_voice', document.getElementById('voice-mode-check').checked);

            const ids = [
                'situation', 'situation-custom',
                'ai-role', 'ai-role-custom',
                'my-role', 'my-role-custom',
                'topic', 'topic-custom',
                'trans-focus', 'trans-focus-custom',
                'first-speaker',
                'level', 'speed'
            ];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if(el) localStorage.setItem('epg_' + id, el.value);
            });
        }

        function loadSettings() {
            const savedMode = localStorage.getItem('epg_mode');
            if (savedMode) {
                const radio = document.querySelector(`input[name="mode"][value="${savedMode}"]`);
                if(radio) radio.checked = true;
            }

            const savedVoice = localStorage.getItem('epg_voice');
            if (savedVoice !== null) {
                document.getElementById('voice-mode-check').checked = (savedVoice === 'true');
            }

            const ids = [
                'situation', 'situation-custom',
                'ai-role', 'ai-role-custom',
                'my-role', 'my-role-custom',
                'topic', 'topic-custom',
                'trans-focus', 'trans-focus-custom',
                'first-speaker',
                'level', 'speed'
            ];
            ids.forEach(id => {
                const val = localStorage.getItem('epg_' + id);
                if (val !== null) {
                    const el = document.getElementById(id);
                    if(el) el.value = val;
                }
            });

            toggleMode();
            ['situation', 'ai-role', 'my-role', 'topic', 'trans-focus'].forEach(id => checkCustom(id));
            generatePrompt();
        }

        window.addEventListener('load', loadSettings);

    </script>

</body>
</html>
